"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.MonTY,n=exports.absenceTypes,l=exports.employees,t=exports.absencesCanUpdate,o=exports.returnsToWorkCanUpdate;function r(r){let a,c,s="";function d(){const e=a.querySelector("#callInAdd--employeeNumber"),n=e.value.toLowerCase();if(n===s)return;s=n;const t=a.querySelector("#callInAdd--employeeName");t.value="";const o=l.filter(e=>n.length>=e.employeeNumber.length/2&&e.employeeNumber.toLowerCase().endsWith(n));1===o.length&&(e.value=o[0].employeeNumber,s=o[0].employeeNumber.toLowerCase(),t.value=(o[0].employeeGivenName+" "+o[0].employeeSurname).trim())}function i(){const e=a.querySelectorAll('input[name="callInType"]');for(const n of e){const e=n.closest("label"),l=a.querySelector(`fieldset[data-call-in-type="${n.value}"]`);n.checked?(e.classList.add("is-link"),e.querySelector(".icon").innerHTML='<i class="fas fa-check" aria-hidden="true"></i>',l.disabled=!1,l.classList.remove("is-hidden")):(e.classList.remove("is-link"),e.querySelector(".icon").innerHTML='<i class="fas fa-minus" aria-hidden="true"></i>',l.classList.add("is-hidden"),l.disabled=!0)}}function u(n){n.preventDefault(),cityssm.postJSON(e.urlPrefix+"/attendance/doRecordCallIn",n.currentTarget,e=>{e.success&&c()})}cityssm.openHtmlModal("callIn-add",{onshow(e){var l,r;if(a=e,t){e.querySelector("#callInAdd--absenceDateTime-absence").valueAsDate=new Date;const l=e.querySelector("#callInAdd--absenceTypeKey-absence");for(const e of n){const n=document.createElement("option");n.value=e.absenceTypeKey,n.textContent=e.absenceType,l.append(n)}}else null===(l=e.querySelector("#callInAdd--callInType_absence"))||void 0===l||l.remove();o||null===(r=e.querySelector("#callInAdd--callInType_returnToWork"))||void 0===r||r.remove()},onshown(e,n){var l,t,o,r;c=n,null===(l=e.querySelector("form"))||void 0===l||l.addEventListener("submit",u),null===(t=e.querySelector("#callInAdd--employeeNumber"))||void 0===t||t.addEventListener("keyup",d),null===(o=e.querySelector("#callInAdd--callInType_absence"))||void 0===o||o.addEventListener("change",i),null===(r=e.querySelector("#callInAdd--callInType_returnToWork"))||void 0===r||r.addEventListener("change",i)}})}const a=document.querySelectorAll(".is-new-call-in-button");for(const e of a)e.addEventListener("click",r)})();