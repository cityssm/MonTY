"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=exports.MonTY;let t=exports.employees;delete exports.employees;let o=t;function l(o){o.preventDefault(),function(o){let l;const n=t.find(e=>e.employeeNumber===o);let r=[];function a(t){var l,n;const a=t.currentTarget.closest("tr"),s=null==a?void 0:a.dataset.propertyName,i=null===(l=null==a?void 0:a.querySelector("input"))||void 0===l?void 0:l.value,u=null===(n=null==a?void 0:a.querySelector("select"))||void 0===n?void 0:n.value;cityssm.postJSON(e.urlPrefix+"/admin/doUpdateEmployeeProperty",{employeeNumber:o,propertyName:s,propertyValue:i,isSynced:u},e=>{const t=e;t.success&&(bulmaJS.alert({message:"Property updated successfully.",contextualColorName:"success"}),r=t.employeeProperties)})}function s(t){const l=t.currentTarget.closest("tr");bulmaJS.confirm({title:"Delete Employee Property",message:"Are you sure you want to remove this employee property?",contextualColorName:"warning",okButton:{text:"Delete Property",callbackFunction:function(){var t,n;const a=null==l?void 0:l.dataset.propertyName,s=null===(t=null==l?void 0:l.querySelector("input"))||void 0===t?void 0:t.value,i=null===(n=null==l?void 0:l.querySelector("select"))||void 0===n?void 0:n.value;cityssm.postJSON(e.urlPrefix+"/admin/doDeleteEmployeeProperty",{employeeNumber:o,propertyName:a,propertyValue:s,isSynced:i},e=>{const t=e;t.success&&(bulmaJS.alert({message:"Property deleted successfully.",contextualColorName:"success"}),r=t.employeeProperties,null==l||l.remove())})}}})}function i(){var e,t;const o=l.querySelector("#employeePropertyTab--current tbody");o.innerHTML="";for(const l of r){const n=document.createElement("tr");n.dataset.propertyName=l.propertyName,n.innerHTML=`<td class="is-size-7">${l.propertyName}</td>\n          <td>\n            <div class="control">\n              <input class="input is-small" name="propertyValue" type="text" maxlength="500" />\n            </div>\n          </td>\n          <td>\n            <div class="control">\n            <div class="select is-small is-fullwidth">\n              <select name="isSynced">\n                <option value="1">Synced</option>\n                <option value="0">Not Synced</option>\n              </select>\n            </div>\n            </div>\n          </td>\n          <td class="has-text-right">\n          <div class="field is-grouped is-justify-content-flex-end">\n            <div class="control">\n            <button class="button is-update-button is-success is-small" data-tooltip="Save" type="button" aria-label="Save">\n              <i class="fas fa-save" aria-hidden="true"></i>\n            </button>\n            </div>\n            <div class="control">\n            <button class="button is-delete-button is-danger is-small" data-tooltip="Delete" type="button" aria-label="Delete">\n              <i class="fas fa-trash" aria-hidden="true"></i>\n            </button>\n            </div>\n          </div>\n          </td>`,n.querySelector("input").value=l.propertyValue,n.querySelector("select").value=l.isSynced?"1":"0",null===(e=n.querySelector(".is-update-button"))||void 0===e||e.addEventListener("click",a),null===(t=n.querySelector(".is-delete-button"))||void 0===t||t.addEventListener("click",s),o.append(n)}}function u(t){t.preventDefault();const o=t.currentTarget;cityssm.postJSON(e.urlPrefix+"/admin/doAddEmployeeProperty",o,e=>{const t=e;t.success?(bulmaJS.alert({message:"Property added successfully.",contextualColorName:"success",okButton:{callbackFunction(){l.querySelector("#employeePropertyAdd--propertyName").focus()}}}),o.reset(),r=t.employeeProperties,i()):bulmaJS.alert({title:"Error Adding Property",message:"The property may already be set. Please check, then try again.",contextualColorName:"danger"})})}function c(o){o.preventDefault(),cityssm.postJSON(e.urlPrefix+"/admin/doUpdateEmployee",o.currentTarget,e=>{const o=e;o.success&&(bulmaJS.alert({message:"Employee updated successfully.",contextualColorName:"success"}),t=o.employees,m())})}cityssm.openHtmlModal("employeeAdmin-employee",{onshow(t){var a,s,u,c,d,m,p;l=t,t.querySelector(".modal-card-title").textContent=n.employeeSurname+", "+n.employeeGivenName,t.querySelector("#employeeEdit--employeeNumber").value=n.employeeNumber,t.querySelector("#employeeEdit--employeeNumberSpan").textContent=n.employeeNumber,t.querySelector("#employeeEdit--isActive").value=n.isActive?"1":"0",t.querySelector("#employeeEdit--isSynced").value=n.isSynced?"1":"0",t.querySelector("#employeeEdit--employeeSurname").value=n.employeeSurname,t.querySelector("#employeeEdit--employeeGivenName").value=n.employeeGivenName,t.querySelector("#employeeEdit--jobTitle").value=null!==(a=n.jobTitle)&&void 0!==a?a:"",t.querySelector("#employeeEdit--department").value=null!==(s=n.department)&&void 0!==s?s:"",""!==(null!==(u=n.seniorityDateTime)&&void 0!==u?u:"")&&(t.querySelector("#employeeEdit--seniorityDateTime").valueAsDate=new Date(n.seniorityDateTime)),t.querySelector("#employeeEdit--syncContacts").value=n.syncContacts?"1":"0",t.querySelector("#employeeEdit--workContact1").value=null!==(c=n.workContact1)&&void 0!==c?c:"",t.querySelector("#employeeEdit--workContact2").value=null!==(d=n.workContact2)&&void 0!==d?d:"",t.querySelector("#employeeEdit--homeContact1").value=null!==(m=n.homeContact1)&&void 0!==m?m:"",t.querySelector("#employeeEdit--homeContact2").value=null!==(p=n.homeContact2)&&void 0!==p?p:"",t.querySelector("#employeePropertyAdd--employeeNumber").value=n.employeeNumber,cityssm.postJSON(e.urlPrefix+"/admin/doGetEmployeeProperties",{employeeNumber:o},e=>{r=e.employeeProperties,i()})},onshown(t,o){var l,n;bulmaJS.toggleHtmlClipped(),bulmaJS.init(t),e.initializeMenuTabs(t.querySelectorAll(".menu a"),t.querySelectorAll(".tabs-container > article")),null===(l=t.querySelector("#form--employeeEdit"))||void 0===l||l.addEventListener("submit",c),null===(n=t.querySelector("#form--employeePropertyAdd"))||void 0===n||n.addEventListener("submit",u)},onremoved(){bulmaJS.toggleHtmlClipped()}})}(o.currentTarget.dataset.employeeNumber)}const n=document.querySelector("#employeeSearch--employeeNameNumber"),r=document.querySelector("#employeeSearch--isActive"),a=document.querySelector("#container--employees"),s=50;let i=0;function u(){var e,t,n,r;if(0===o.length)return void(a.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no employees that meet your search criteria.</p>\n        </div>');const u=document.createElement("div");u.className="panel";for(let n=i;n<Math.min(s+i,o.length);n+=1){const r=o[n],a=document.createElement("a");a.className="panel-block is-block",r.isActive||a.classList.add("is-italic","has-background-warning-light"),a.href="#",a.dataset.employeeNumber=null!==(e=r.employeeNumber)&&void 0!==e?e:"",a.innerHTML=`<div class="columns">\n        <div class="column is-narrow">\n          <i class="fas fa-hard-hat" aria-hidden="true"></i>\n        </div>\n        <div class="column">${r.employeeNumber}</div>\n        <div class="column">\n          ${r.employeeSurname}, ${r.employeeGivenName}<br />\n          <span class="is-size-7">\n            ${null!==(t=r.jobTitle)&&void 0!==t?t:""}\n          </span>\n        </div>\n        </div>`,a.addEventListener("click",l),u.append(a)}a.innerHTML="",a.append(u);const m=document.createElement("div");m.className="field is-grouped is-justify-content-center",m.innerHTML='<div class="control">\n      <button class="button is-previous-button" data-tooltip="Previous Employees" type="button" aria-label="Previous">\n        <i class="fas fa-arrow-left" aria-hidden="true"></i>\n      </button>\n      <button class="button is-next-button" data-tooltip="Next Employees" type="button" aria-label="Next">\n        <span>Next</span>  \n        <span class="icon is-small"><i class="fas fa-arrow-right" aria-hidden="true"></i></span>\n      </button>\n      </div>',0===i?m.querySelector(".is-previous-button").disabled=!0:null===(n=m.querySelector(".is-previous-button"))||void 0===n||n.addEventListener("click",c),s+i>=o.length?m.querySelector(".is-next-button").disabled=!0:null===(r=m.querySelector(".is-next-button"))||void 0===r||r.addEventListener("click",d),a.append(m)}function c(){i=Math.max(i-s,0),u()}function d(){(i+=s)>=o.length&&(i=0),u()}function m(){o=t.filter(e=>{if("1"===r.value&&!e.isActive||"0"===r.value&&e.isActive)return!1;const t=(e.employeeGivenName+" "+e.employeeSurname+" "+e.employeeNumber).toLowerCase(),o=n.value.trim().toLowerCase().split(" ");for(const e of o)if(!t.includes(e))return!1;return!0}),u()}function p(){i=0,m()}p(),n.addEventListener("keyup",p),r.addEventListener("change",p)})();