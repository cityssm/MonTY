"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=exports.MonTY,o=exports.afterHoursReasons,n=exports.employees;let s=exports.afterHoursRecords;const r=exports.employeeNumberRegularExpression;function a(){var e,t;const o=document.querySelector("#container--afterHours");if(null===o)return;if(0===s.length)return void(o.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no recent after hours records to show.</p>\n        </div>');const n=document.createElement("div");n.className="panel";let r=0;for(const o of s){const s=new Date(o.attendanceDateTime),a=document.createElement("div");a.className="panel-block is-block",Date.now()-s.getTime()<=864e5&&(a.classList.add("has-background-success-light"),r+=1),a.tabIndex=0,a.innerHTML=`<div class="columns is-mobile">\n        <div class="column is-narrow">\n          <i class="fas fa-clock" aria-hidden="true"></i>\n        </div>\n        <div class="column is-3">\n          <strong data-tooltip="Attendance Date">\n            ${s.toLocaleDateString()}\n            </strong><br />\n            <span class="is-size-7">${s.toLocaleTimeString()}</span>\n        </div>\n        <div class="column">\n          <strong>${o.employeeName}</strong><br />\n          <span class="is-size-7">${null!==(e=o.employeeNumber)&&void 0!==e?e:""}</span>\n        </div>\n        <div class="column">\n          <strong data-tooltip="Absence Type">${o.afterHoursReason}</strong><br />\n          <span class="is-size-7">${null!==(t=o.recordComment)&&void 0!==t?t:""}</span>\n        </div>\n        </div>`,n.append(a)}o.innerHTML="",o.append(n),document.querySelector('#menu--attendance a[href="#tab--afterHours"] .tag').textContent=r.toString()}null===(e=document.querySelector(".is-new-after-hours-button"))||void 0===e||e.addEventListener("click",()=>{let e,l,c="";function u(){const t=e.querySelector("#afterHoursAdd--employeeNumber"),o=t.value.toLowerCase();if(o===c)return;c=o;const s=e.querySelector("#afterHoursAdd--employeeName");s.value="";const r=n.filter(e=>o.length>=e.employeeNumber.length/2&&e.employeeNumber.toLowerCase().endsWith(o));1===r.length&&(t.value=r[0].employeeNumber,c=r[0].employeeNumber.toLowerCase(),s.value=(r[0].employeeGivenName+" "+r[0].employeeSurname).trim())}function d(e){e.preventDefault(),cityssm.postJSON(t.urlPrefix+"/attendance/doAddAfterHoursRecord",e.currentTarget,e=>{const t=e;t.success&&(l(),bulmaJS.alert({message:"After hours attendance recorded successfully."}),s=t.afterHoursRecords,a())})}cityssm.openHtmlModal("afterHours-add",{onshow(t){e=t;const n=t.querySelector("#afterHoursAdd--afterHoursReasonId");for(const e of o){const t=document.createElement("option");t.value=e.afterHoursReasonId.toString(),t.textContent=e.afterHoursReason,n.append(t)}},onshown(e,t){var o;l=t,bulmaJS.toggleHtmlClipped(),null===(o=e.querySelector("form"))||void 0===o||o.addEventListener("submit",d);const n=e.querySelector("#afterHoursAdd--employeeNumber");void 0!==r&&(n.pattern=r.source),n.focus(),n.addEventListener("keyup",u)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),a()})();