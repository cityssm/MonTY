"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;const t=exports.MonTY;let l=exports.callOutLists;delete exports.callOutLists;exports.callOutsCanUpdate;const s=exports.callOutsCanManage,n=document.querySelector("#callOuts--searchFilter"),i=document.querySelector("#callOuts--searchResults");function o(){var e,t;const s=document.createElement("div");s.className="panel";const o=n.value.trim().toLowerCase().split(" ");for(const n of l){let l=!0;const i=(n.listName+" "+(null!==(e=n.listDescription)&&void 0!==e?e:"")).toLowerCase();for(const e of o)if(!i.includes(e)){l=!1;break}if(!l)continue;const c=document.createElement("a");c.className="panel-block",c.dataset.listId=n.listId.toString(),c.href="#",c.innerHTML=`<span class="panel-icon">\n        <i class="fas fa-list-ol" aria-hidden="true"></i>\n        </span>\n        <div>\n          <strong>${n.listName}</strong><br />\n          <span class="is-size-7">${null!==(t=n.listDescription)&&void 0!==t?t:""}</span>\n        </div>`,c.addEventListener("click",a),s.append(c)}s.hasChildNodes()?(i.innerHTML="",i.append(s)):i.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no call out lists that meet your search criteria.</p>\n        </div>'}function a(e){e.preventDefault(),function(e){const n=l.find(t=>t.listId===e);let i;function a(e){e.preventDefault(),s?cityssm.postJSON(t.urlPrefix+"/attendance/doUpdateCallOutList",e.currentTarget,e=>{const t=e;t.success?(bulmaJS.alert({message:"Call out list updated successfully.",contextualColorName:"success"}),i.querySelector(".modal-card-title").textContent=i.querySelector("#callOutListEdit--listName").value,l=t.callOutLists,o()):bulmaJS.alert({title:"Error Updating Call Out List",message:"Please try again.",contextualColorName:"danger"})}):bulmaJS.alert({title:"Access Denied",message:"You do not have permission to update call out lists.",contextualColorName:"danger"})}cityssm.openHtmlModal("callOuts-list",{onshow(e){var t,l,o,c,r,u;i=e,e.querySelector(".modal-card-title").textContent=n.listName,s&&(null===(l=null===(t=e.querySelector(".menu a[href$='tab--callOuts-memberManagement']"))||void 0===t?void 0:t.closest("li"))||void 0===l||l.classList.remove("is-hidden")),e.querySelector("#callOutListEdit--listId").value=n.listId,e.querySelector("#callOutListEdit--listName").value=n.listName,e.querySelector("#callOutListEdit--listDescription").value=null!==(o=n.listDescription)&&void 0!==o?o:"";let d=!1;const m=e.querySelector("#callOutListEdit--eligibilityFunction");for(const e of exports.employeeEligibilityFunctionNames){const t=document.createElement("option");t.value=e,t.textContent=e,e===n.eligibilityFunction&&(t.selected=!0,d=!0),m.append(t)}if(!d&&""!==(null!==(c=n.eligibilityFunction)&&void 0!==c?c:"")){const e=document.createElement("option");e.value=n.eligibilityFunction,e.textContent=n.eligibilityFunction,e.selected=!0,m.append(e)}let p=!1;const v=e.querySelector("#callOutListEdit--sortKeyFunction");for(const e of exports.employeeSortKeyFunctionNames){const t=document.createElement("option");t.value=e,t.textContent=e,e===n.sortKeyFunction&&(t.selected=!0,p=!0),v.append(t)}if(!p&&""!==(null!==(r=n.sortKeyFunction)&&void 0!==r?r:"")){const e=document.createElement("option");e.value=n.sortKeyFunction,e.textContent=n.sortKeyFunction,e.selected=!0,v.append(e)}if(s){const t=e.querySelector("#callOutListEdit--unlockButtons");t.classList.remove("is-hidden"),null===(u=t.querySelector("button"))||void 0===u||u.addEventListener("click",()=>{var l;t.remove(),null===(l=e.querySelector("#callOutListEdit--updateButtons"))||void 0===l||l.classList.remove("is-hidden");const s=e.querySelector("#form--callOutListEdit");s.addEventListener("submit",a),s.querySelector("fieldset").disabled=!1})}},onshown(e,l){t.initializeMenuTabs(e.querySelectorAll(".menu a"),e.querySelectorAll(".tabs-container > article"))}})}(e.currentTarget.dataset.listId)}null===(e=document.querySelector("#callOuts--create"))||void 0===e||e.addEventListener("click",()=>{let e;function s(s){s.preventDefault(),cityssm.postJSON(t.urlPrefix+"/attendance/doCreateCallOutList",s.currentTarget,t=>{l=t.callOutLists,o(),e()})}cityssm.openHtmlModal("callOuts-createList",{onshown(t,l){var n;e=l,null===(n=t.querySelector("#form--callOutListAdd"))||void 0===n||n.addEventListener("submit",s)}})}),o(),n.addEventListener("keyup",o)})();