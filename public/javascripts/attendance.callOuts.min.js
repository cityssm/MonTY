"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var t;const e=exports.MonTY,s=document.querySelector("#callOuts--searchFilter"),l=document.querySelector("#callOuts--searchResults");function a(t){const s=t.currentTarget,l="1"===s.dataset.isFavourite,a=s.closest(".panel-block").dataset.listId;cityssm.postJSON(e.urlPrefix+(l?"/attendance/doRemoveFavouriteCallOutList":"/attendance/doAddFavouriteCallOutList"),{listId:a},t=>{const s=t;e.callOuts.callOutLists=s.callOutLists,n()})}function n(){var t,n,o,c,r;const u=document.createElement("div");u.className="panel";const d=s.value.trim().toLowerCase().split(" ");for(const s of e.callOuts.callOutLists){let e=!0;const l=(s.listName+" "+(null!==(t=s.listDescription)&&void 0!==t?t:"")).toLowerCase();for(const t of d)if(!l.includes(t)){e=!1;break}if(!e)continue;const v=document.createElement("div");v.className="panel-block is-block",v.dataset.listId=s.listId.toString(),v.innerHTML=`<div class="columns is-mobile">\n        <div class="column is-narrow">\n          <button class="button is-white" data-is-favourite="${s.isFavourite?"1":"0"}" data-tooltip="Toggle Favourite" type="button">\n            ${s.isFavourite?'<i class="fas fa-star" aria-label="Favourite"></i>':'<i class="far fa-star" aria-label="Not Favourite"></i>'}\n          </button>\n        </div>\n        <div class="column">\n          <a class="is-block" href="#">\n          <strong>${s.listName}</strong><br />\n            <span class="is-size-7">${(null!==(n=s.listDescription)&&void 0!==n?n:"").replace(/\n/g,"<br />")}</span>\n          </a>\n        </div>\n        <div class="column is-narrow">\n          <span class="tag" data-tooltip="Members">\n            <span class="icon is-small"><i class="fas fa-hard-hat" aria-hidden="true"></i></span>\n            <span>${null!==(o=s.callOutListMembersCount)&&void 0!==o?o:""}</span>\n          </span>\n        </div>\n        </div>`,null===(c=v.querySelector("button"))||void 0===c||c.addEventListener("click",a),null===(r=v.querySelector("a"))||void 0===r||r.addEventListener("click",i),u.append(v)}u.hasChildNodes()?(l.innerHTML="",l.append(u)):l.innerHTML='<div class="message is-info">\n        <p class="message-body">There are no call out lists that meet your search criteria.</p>\n        </div>'}function i(t){var s;t.preventDefault();const l=t.currentTarget.closest(".panel-block").dataset.listId;null===(s=e.callOuts)||void 0===s||s.openCallOutList(l,n)}null===(t=document.querySelector("#callOuts--create"))||void 0===t||t.addEventListener("click",()=>{let t;function s(s){s.preventDefault(),cityssm.postJSON(e.urlPrefix+"/attendance/doCreateCallOutList",s.currentTarget,s=>{var l;const a=s;e.callOuts.callOutLists=a.callOutLists,n(),null===(l=e.callOuts)||void 0===l||l.openCallOutList(a.listId),t()})}cityssm.openHtmlModal("callOuts-createList",{onshown(e,l){var a;t=l,bulmaJS.toggleHtmlClipped(),e.querySelector("#callOutListAdd--listName").focus(),null===(a=e.querySelector("#form--callOutListAdd"))||void 0===a||a.addEventListener("submit",s)},onremoved(){bulmaJS.toggleHtmlClipped()}})}),n(),s.addEventListener("keyup",n)})();